#define MAIN_ANALYSIS {ANALYSIS}
/* -*- C++ -*- */
// vim: syntax=cpp

#include <satire.h>
#include "main.h"
#include "main-support.h"

// BEGIN
// CHANGE
#include "{ANALYSIS}-out/src/{ANALYSIS}.h"
#include "visualisation.h"

#define ANALYSIS_{ANALYSIS} // is used to flag default-values in cmdline options/parser
#include "ShapeAnalysisDriver.h"
#include "PagAttributes.C"
#include "ShapeImplementation.C"
#include "AliasStatistics.C"
#include "visualisation.c"

AliasStatistics *stats;
ShapeAnalyzerOptions *opt;
// END

int main(int argc, char **argv)
{
    using namespace SATIrE;
    /* Instantiate an analysis driver with the command line arguments, and
     * build a new data flow analysis instance for the appropriate
     * implementation class. MAIN_ANALYSIS is a macro whose definition is
     * generated by the newanalysis script. */
    
    // BEGIN
    // AnalysisDriver analysisDriver(argc, argv);
    //DataFlowAnalysis *analysis
    //    = new DataFlowAnalysis(new SATIrE::MAIN_ANALYSIS::Implementation());
    // CHANGE 
    ShapeAnalysisDriver analysisDriver(argc, argv);
    opt = (ShapeAnalyzerOptions*)analysisDriver.getOptions();
    DataFlowAnalysis *analysis
        = new DataFlowAnalysis(new SATIrE::MAIN_ANALYSIS::ShapeImplementation());
    stats = new AliasStatistics();
    // END

    /* The addDependencies function is generated by the newanalysis script
     * in main-support.C to declare any dependencies that this analysis has
     * on other analyses. */
    addDependencies(analysis);

    /* Run any dependencies and then the analysis itself. */
    analysisDriver.run(analysis);
}
